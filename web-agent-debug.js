(()=>{"use strict";var e={629:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(176));window.EcoCss={startWebAgent:i.default}},176:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(358));t.default=e=>{let t=0;t=performance.now();const s=new i.default(e);console.log("bootstrapped in",performance.now()-t),performance.clearMarks(),performance.clearMeasures(),Object.assign(window,{EcoCssDebug:{getPerformanceStats(){const e={};let t=performance.getEntriesByName("collect-classes").filter((e=>"measure"===e.entryType)).map((e=>e.duration)),s=t.reduce(((e,t)=>e+t),0);return e["collect-classes"]={totalMeasures:t.length,totalTime:s,avgTime:s/t.length},t=performance.getEntriesByName("update-style").filter((e=>"measure"===e.entryType)).map((e=>e.duration)),s=t.reduce(((e,t)=>e+t),0),e["update-style"]={totalMeasures:t.length,totalTime:s,avgTime:s/t.length},e},resetPerformance(){performance.clearMarks(),performance.clearMeasures()},printPerformanceStats(){const e=this.getPerformanceStats(),t=e["collect-classes"];console.log("Collect classes performance:"),console.group(),console.log("Measures:",t.totalMeasures),console.log("Total time (ms):",t.totalTime),console.log("Average time (ms):",t.avgTime),console.groupEnd();const s=(t,s)=>{const r=e[t];console.log(s),console.group(),console.log("Measures:",r.totalMeasures),console.log("Total time (ms):",r.totalTime),console.log("Average time (ms):",r.avgTime),console.groupEnd()};s("collect-classes","Collect classes performance:"),s("update-style","Update style performance:")}}});const r={attributes:!0,attributeFilter:["class"],childList:!0,subtree:!0},n=new Set,o=[],a=document.getElementById("eco-style"),d=document.createElement("style");d.innerText=s.baseStyle,a&&a.parentElement?a.parentElement.insertBefore(d,a):document.head.appendChild(d);const c=a||document.createElement("style");a||document.head.appendChild(c);const l=e=>{performance.mark("collect-classes");const t=new Set;if(e){const s=document.createNodeIterator(e,NodeFilter.SHOW_ELEMENT);for(let e=s.nextNode();e;e=s.nextNode()){const s=e.getAttribute("class"),r=s&&s.split(/\s+/);r&&r.forEach((e=>{t.add(e)}))}}return performance.measure("collect-classes","collect-classes"),t};let u=!1;const f=()=>{u||(u=!0,window.requestAnimationFrame((()=>{(e=>{performance.mark("update-style");const t=n.size;for(let t=0;t<e.length;t+=1)n.add(e[t]);n.size!==t&&(c.innerText=s.updateCss(e)),performance.measure("update-style","update-style")})(o),o.length=0,u=!1})))},m=new MutationObserver((function(e){for(const t of e)if("childList"===t.type)for(let e=0;e<t.addedNodes.length;e+=1){const s=t.addedNodes[e];s.nodeType===Node.ELEMENT_NODE&&(o.push(...l(s)),o.length&&f())}else if("attributes"===t.type&&"class"===t.attributeName){const e=t.target;if(e.nodeType!==Node.ELEMENT_NODE)continue;o.push(...e.className.trim().split(/\s+/)),o.length&&f()}}));if(document.body)m.observe(document.body,r),o.push(...l(document.body)),o.length&&f();else{const e=new MutationObserver((t=>{for(let s=0;s<t.length;s+=1)if(t[s].addedNodes)for(let i=0;i<t[s].addedNodes.length;i+=1)if(t[s].addedNodes[i]===document.body)return m.observe(document.body,r),void e.disconnect()}));e.observe(document.children[0],{childList:!0})}return s}},352:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(646),n=s(795),o=s(625),a=r(s(25)),d=s(24);t.default=class{config;classDefMap;pattern;modStore;classParser;extractorRe;baseStyle;providers;constructor(e){this.config=e,this.baseStyle=e.baseStyle||"",this.modStore=new a.default(e.modifiers);const t=e.modifiers?Object.keys(e.modifiers):[];this.pattern=new i.Pattern(t,e.pattern),this.classDefMap={},this.providers=e.providers,this.updateRe()}updateRe(){const e=this.getClassRegExpString(),t=new RegExp(`^${e}$`);this.classParser=e=>{const s=(0,o.parseClass)(t,this.getVariableSegments(),e);return s&&new d.ClassUsage(e,s)},this.extractorRe=new RegExp(e,"g")}getClassDefinition(e){if(this.classDefMap[e])return this.classDefMap[e];let t;for(let s=0;s<this.providers.length;s+=1)if(t=this.providers[s].getDefinition(e),t)return this.classDefMap[e]=t,t;throw new Error(`Class with base '${e}' is not defined`)}getPatternSegments(){return this.pattern.segments}getVariableSegments(){return this.pattern.variableSegments}getModifierNames(e){if(this.config.modifiers){const t=this.config.modifiers[e];if(t)return Object.keys(t)}throw new Error(`config.modifiers.${e} is not defined`)}getSegmentNames(e){return this.getModifierNames(e)}getSegmentNameMap(){return this.pattern.segments.reduce(((e,t)=>(t.key&&"base"!==t.key&&(e[t.key]=this.getSegmentNames(t.key)),e)),{})}getClassRegExpString(){return(0,n.getClassRegExpString)(this.getPatternSegments(),this.getSegmentNameMap(),this.providers.reduce(((e,t)=>(e.push(...t.getPatterns()),e)),[]))}}},358:function(e,t,s){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(s(352)),n=s(137),o=s(512),a=s(879);class d{core;mediaQueues;renderedTaskSet;rulesetCache;baseStyle;constructor(e){this.core=new i.default(e),this.mediaQueues=d.newMediaQueueMap(),this.rulesetCache={},this.renderedTaskSet=new Set,this.baseStyle=e.baseStyle||""}static newMediaQueueMap(){return{"":{medias:[],classRenderTasks:[]}}}compareMediaRenderTasks(e,t){return e.medias.length!==t.medias.length?e.medias.length-t.medias.length:this.core.modStore.compareModifierSets(e.medias,t.medias)}compareClassRenderTasks(e,t){return e.instance.declMap.size!==t.instance.declMap.size?t.instance.declMap.size-e.instance.declMap.size:e.modifiers.length!==t.modifiers.length?e.modifiers.length-t.modifiers.length:e.id.localeCompare(t.id)}buildMediaRenderTaskMap(e,t){return t.forEach((t=>{const s=this.core.getClassDefinition(t.base);null!==s&&s.instances.forEach((s=>{const r=Array.from(new Set([...s.modifierNames,...t.modifierNames])).filter((e=>this.core.modStore.isMediaModifier(e))).sort(),i=r.join("\\");e[i]||(e[i]={medias:r,classRenderTasks:[]});const n=`${i}\\${t.className}`;this.renderedTaskSet.has(n)||e[i].classRenderTasks.push({id:n,classUsage:t,instance:s,modifiers:this.core.modStore.mergeModifiers(t.modifierNames,s.modifierNames)})}))})),Object.keys(e).map((t=>(e[t].classRenderTasks.sort(this.compareClassRenderTasks.bind(this)),e[t]))).sort(this.compareMediaRenderTasks.bind(this))}_generateCss(e,t){const s=Array.from(new Set(t)).sort().map((e=>this.core.classParser(e))).filter((e=>e));return this.buildMediaRenderTaskMap(e,s).reduce(((e,t)=>{const s=t.classRenderTasks;if(!s.length)return e;const r=t.medias,i=s.map((e=>this.getRuleSet(e)));return r.length?`${e}@media ${this.core.modStore.getMediaQueryString(r)}{${i.join("")}}`:`${e}${i.join("")}`}),"")}generateCss(e){return this._generateCss(d.newMediaQueueMap(),e)}updateCss(e){return this._generateCss(this.mediaQueues,e)}getClassSelector(e,t){const s=this.core.modStore.mergeModifiers(e.modifierNames,t.modifierNames),r=s.map((e=>this.core.modStore.getLeftSide(e))).join(""),i=s.map((e=>this.core.modStore.getRightSide(e))).join("");return`${r}.${(0,o.escapeCssSelector)((0,n.generateClassName)(this.core.getPatternSegments(),e.modifierMap))}${i}`}getDeclarations(e){return(0,a.getDeclarations)(e.declMap)}getRuleSet(e){if(!this.rulesetCache[e.id]){const{classUsage:t,instance:s}=e,r=this.getClassSelector(t,s),i=this.getDeclarations(s);this.rulesetCache[e.id]=`${r}{${i}}`}return this.rulesetCache[e.id]}}t.default=d},25:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=s(84),i=s(425);t.default=class{modifiersCfg;modifierMap;compareModifiers;constructor(e){this.modifiersCfg=e;const t=e?Object.keys(e):[];if(e){let s=0;this.modifierMap=t.reduce(((t,r)=>{if(!e)return t;const n=e[r];return Object.keys(n).forEach((e=>{const r=n[e];t[e]={leftSide:r.leftSide,rightSide:r.rightSide,media:r.media?(0,i.parseMedia)(r.media):void 0,index:s++}})),t}),{})}else this.modifierMap={};this.compareModifiers=(e,t)=>this.modifierMap[e].index-this.modifierMap[t].index}has(e){return!!this.modifierMap[e]}compareModifierSets(e,t){if(e.length!==t.length)return e.length-t.length;const s=e.map((e=>this.getModifierIndex(e))).sort(),r=t.map((e=>this.getModifierIndex(e))).sort();for(let e=0;e<s.length;e+=1)if(s[e]!==r[e])return s[e]-r[e];return 0}isMediaModifier(e){return!!this.modifierMap[e].media}getRightSide(e){const t=this.modifierMap[e];return t&&t.rightSide||""}getLeftSide(e){const t=this.modifierMap[e];return t&&t.leftSide||""}getMediaQueryString(e){return(0,r.getMediaQueryString)(this.modifierMap,e)}getModifierIndex(e){return this.modifierMap[e].index}mergeModifiers(e,t){return Array.from(new Set([...e,...t])).sort(this.compareModifiers)}mergeSets(e,t){return new Set([...e,...t])}sortModifiers(e){return Array.from(e).sort(this.compareModifiers)}getModifierNames(e){if(this.modifiersCfg){const t=this.modifiersCfg.modifiers[e];if(t)return Object.keys(t)}throw new Error(`config.modifiers.${e} is not defined`)}}},512:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.escapeCssSelector=void 0;const s=/[!"#$%&'()[\]{}*+,./:;<>=?@\\^`|~]/g;t.escapeCssSelector=function(e){return e.replace(s,"\\$&")}},879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDeclarations=void 0,t.getDeclarations=function(e){const t=e.entries();let s="";for(let e=t.next();!e.done;e=t.next())s+=`${e.value.join(":")};`;return s}},24:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ClassUsage=void 0,t.ClassUsage=class{className;modifierMap;isBase;modifierNames;base;constructor(e,t){this.className=e,this.modifierMap=t,this.base=this.modifierMap.base,this.modifierNames=new Set(Object.keys(this.modifierMap).filter((e=>"base"!==e)).map((e=>this.modifierMap[e])).filter((e=>e))),this.isBase=!this.modifierNames.size}}},137:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateClassName=void 0,t.generateClassName=function(e,t){return e.reduce(((e,s)=>"string"!=typeof s.key?`${e}${s.value||""}`:t[s.key]?`${e}${s.prefix}${t[s.key]}${s.postfix}`:e),"")}},84:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getMediaQueryString=void 0,t.getMediaQueryString=function(e,t){let s,r="";const i=new Set;t.sort(((t,s)=>e[t].index-e[s].index));for(let n=0;n<t.length;n+=1){if(!e[t[n]])throw new Error(`Modifier '${t[n]}' is not defined`);const o=e[t[n]].media;if(!o)continue;const a=o.mediaType;if(r&&a&&r!==a)throw new Error(`Modifiers '${s}' and '${t[n]}' can't be used together: conflicting media types`);a&&(r=a,s=t[n]);for(let e=0;e<o.mediaFeatures.length;e+=1)i.add(o.mediaFeatures[e])}return`${r?r+" and ":""}${Array.from(i).join(" and ")}`}},425:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseMedia=void 0,t.parseMedia=function(e){const t=e.match(/^\s*(?:(?:(only|not)\s+)?(screen|print|all|speech)(?:\s+and)?\s*)?(\(.+\))?\s*$/);if(!t)throw new Error(`Media query has incorrect format: '${e}'`);return{mediaType:[t[1],t[2]].filter((e=>e)).join(" "),mediaFeatures:t[3]?t[3].split(/\s*and\s*/):[]}}},625:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseClass=void 0,t.parseClass=function(e,t,s){const r=s.match(e);if(!r)return null;const i={};for(let e=0;e<t.length;e+=1)i[t[e].key]=r[t[e].matchIndex]||"";return i}},646:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Pattern=void 0;const r=s(111),i=s(882);t.Pattern=class{segments;variableSegments;constructor(e,t){const s=(0,r.getPatternRe)(e);this.segments=(0,i.parsePattern)(s,t),this.variableSegments=this.segments.filter((e=>"string"==typeof e.key&&"number"==typeof e.matchIndex))}}},795:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getClassRegExpString=void 0;const r=s(928);t.getClassRegExpString=function(e,t,s){return e.map((e=>{if("string"!=typeof e.key)return`(?:${(0,r.escapeRegExp)(e.value||"")||""})`;const i=("base"===e.key?s:t[e.key]).sort(((e,t)=>t.length-e.length)).join("|");return`(?:${(0,r.escapeRegExp)(e.prefix||"")}(${i})${(0,r.escapeRegExp)(e.postfix||"")})${e.optional?"?":""}`})).join("")}},111:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPatternRe=void 0;const r=s(689);t.getPatternRe=function(e){return new RegExp((0,r.getOrExpr)([...e,"base"]),"g")}},882:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePattern=void 0,t.parsePattern=function(e,t){const s=t.split(" ").filter((e=>!!e));let r=0;return s.map((t=>{const s=t.match(e);if(s){if(s.length>1)throw Error(`pattern: segment '${t}' cannot represent both '${s[0]}' and '${s[1]}'`);const e=s[0];r+=1;const[i,n]=t.split(e);return{key:e,optional:"base"!==e,prefix:i,postfix:n,matchIndex:r}}return{value:t,optional:!1,prefix:"",postfix:""}}))}},928:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.escapeRegExp=void 0;const s=/[-[\]{}()*+?.,\\^$|#\s]/g;t.escapeRegExp=function(e){return e.replace(s,"\\$&")}},689:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getOrExpr=void 0;const r=s(928);t.getOrExpr=function(e){return e.sort(((e,t)=>t.length-e.length)).map(r.escapeRegExp).join("|")}}},t={};!function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,s),n.exports}(629)})();